<!-- Exams Page -->
<div class="p-6 bg-white dark:bg-gray-900 block sm:flex items-center justify-between border-b border-gray-200 dark:border-gray-700">
    <div class="w-full mb-1">
        <h1 class="text-xl font-semibold text-gray-900 dark:text-gray-100 sm:text-2xl">Exams & Assessments</h1>
        <p class="text-gray-600 dark:text-gray-300">Manage exams and create questions for your subjects</p>
    </div>
</div>

<div class="p-4">
    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-4">
            <p class="text-sm text-gray-600 dark:text-gray-300">Upcoming Exams</p>
            <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100">3</h3>
        </div>
        <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-4">
            <p class="text-sm text-gray-600 dark:text-gray-300">Pending Grading</p>
            <h3 class="text-2xl font-bold text-orange-600 dark:text-orange-400">5</h3>
        </div>
        <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-4">
            <p class="text-sm text-gray-600 dark:text-gray-300">Completed</p>
            <h3 class="text-2xl font-bold text-green-600 dark:text-green-400">12</h3>
        </div>
    </div>

    <!-- Tabs -->
    <div class="mb-6 border-b border-gray-200 dark:border-gray-700">
        <ul class="flex flex-wrap -mb-px text-sm font-medium text-center">
            <li class="mr-2">
                <button onclick="switchTab('upcoming')" id="upcomingTab" class="inline-block p-4 text-primary-600 dark:text-primary-400 border-b-2 border-primary-600 dark:border-primary-400 rounded-t-lg active">
                    Upcoming Exams
                </button>
            </li>
            <li class="mr-2">
                <button onclick="switchTab('questions')" id="questionsTab" class="inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600">
                    Exam Questions
                </button>
            </li>
        </ul>
    </div>

    <!-- Upcoming Exams Tab -->
    <div id="upcomingContent" class="tab-content">
        <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Upcoming Exams</h3>
            </div>
            <div class="space-y-4">
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600">
                    <div class="flex-1">
                        <h4 class="font-semibold text-gray-900 dark:text-gray-100">Mathematics Mid-Term Exam</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">JSS 2A • Feb 15, 2026 • 2 hours • 100 marks</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Questions: 50 (Theory: 30, Objectives: 20)</p>
                    </div>
                    <button onclick="manageQuestions('Mathematics Mid-Term Exam')" class="px-4 py-2 text-white bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 rounded-lg text-sm">
                        <i class="fas fa-edit mr-2"></i>Manage Questions
                    </button>
                </div>
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600">
                    <div class="flex-1">
                        <h4 class="font-semibold text-gray-900 dark:text-gray-100">Physics Final Exam</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">SSS 1B • Feb 20, 2026 • 3 hours • 100 marks</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Questions: 45 (Theory: 25, Objectives: 20)</p>
                    </div>
                    <button onclick="manageQuestions('Physics Final Exam')" class="px-4 py-2 text-white bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 rounded-lg text-sm">
                        <i class="fas fa-edit mr-2"></i>Manage Questions
                    </button>
                </div>
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600">
                    <div class="flex-1">
                        <h4 class="font-semibold text-gray-900 dark:text-gray-100">Chemistry Practical Test</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">SSS 2A • Feb 25, 2026 • 1.5 hours • 50 marks</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Questions: 10 (Practical: 10)</p>
                    </div>
                    <button onclick="manageQuestions('Chemistry Practical Test')" class="px-4 py-2 text-white bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 rounded-lg text-sm">
                        <i class="fas fa-edit mr-2"></i>Manage Questions
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Exam Questions Tab -->
    <div id="questionsContent" class="tab-content hidden">
        <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-6 mb-6">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Select Exam to Manage Questions</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">Exam</label>
                    <select id="examSelect" onchange="loadExamQuestions()" class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                        <option value="">Select Exam</option>
                        <option value="math_midterm">Mathematics Mid-Term Exam</option>
                        <option value="physics_final">Physics Final Exam</option>
                        <option value="chemistry_practical">Chemistry Practical Test</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">Question Type</label>
                    <select id="questionType" class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                        <option>Theory</option>
                        <option>Objective</option>
                        <option>Practical</option>
                    </select>
                </div>
                <div class="flex items-end">
                    <button onclick="openAddQuestionModal()" class="w-full px-5 py-2.5 text-white bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 font-medium rounded-lg text-sm">
                        <i class="fas fa-plus mr-2"></i>Add Question
                    </button>
                </div>
            </div>
        </div>

        <!-- Questions List -->
        <div id="questionsList" class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm overflow-hidden" style="display: none;">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Exam Questions - <span id="examTitle"></span></h3>
            </div>
            <div class="p-4">
                <div id="questionsContainer" class="space-y-4">
                    <!-- Questions will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div id="questionsEmptyState" class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-12 text-center">
            <i class="fas fa-clipboard-list text-6xl text-gray-300 dark:text-gray-500 mb-4"></i>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2">No Exam Selected</h3>
            <p class="text-gray-600 dark:text-gray-300">Select an exam above to view and manage questions.</p>
        </div>
    </div>
</div>

<!-- Add Question Modal -->
<div id="addQuestionModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 p-6 max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Add Exam Question</h3>
            <button onclick="closeAddQuestionModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <form id="addQuestionForm" onsubmit="saveQuestion(event)">
            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">Question Number</label>
                <input type="number" id="questionNumber" required class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" placeholder="1">
            </div>
            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">Question Text</label>
                <textarea id="questionText" rows="4" required class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" placeholder="Enter the question..."></textarea>
            </div>
            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">Marks</label>
                <input type="number" id="questionMarks" required class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" placeholder="10">
            </div>
            <div id="objectiveOptions" class="mb-4" style="display: none;">
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">Options (for Objective Questions)</label>
                <div class="space-y-2">
                    <input type="text" id="optionA" class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg block w-full p-2.5" placeholder="Option A">
                    <input type="text" id="optionB" class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg block w-full p-2.5" placeholder="Option B">
                    <input type="text" id="optionC" class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg block w-full p-2.5" placeholder="Option C">
                    <input type="text" id="optionD" class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg block w-full p-2.5" placeholder="Option D">
                </div>
                <div class="mt-2">
                    <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">Correct Answer</label>
                    <select id="correctAnswer" class="bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg block w-full p-2.5">
                        <option>A</option>
                        <option>B</option>
                        <option>C</option>
                        <option>D</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-end gap-3">
                <button type="button" onclick="closeAddQuestionModal()" class="px-4 py-2 text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg">Cancel</button>
                <button type="submit" class="px-4 py-2 text-white bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 rounded-lg">
                    <i class="fas fa-save mr-2"></i>Save Question
                </button>
            </div>
        </form>
    </div>
</div>



<script>
let examQuestions = {
    'math_midterm': [],
    'physics_final': [],
    'chemistry_practical': []
};

function switchTab(tab) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
    document.querySelectorAll('[id$="Tab"]').forEach(el => {
        el.classList.remove('text-primary-600', 'border-primary-600');
        el.classList.add('border-transparent');
    });
    
    // Show selected tab
    if(tab === 'upcoming') {
        document.getElementById('upcomingContent').classList.remove('hidden');
        document.getElementById('upcomingTab').classList.add('text-primary-600', 'border-primary-600');
    } else if(tab === 'questions') {
        document.getElementById('questionsContent').classList.remove('hidden');
        document.getElementById('questionsTab').classList.add('text-primary-600', 'border-primary-600');
    }
}

function manageQuestions(examName) {
    switchTab('questions');
    // Auto-select the exam
    const examMap = {
        'Mathematics Mid-Term Exam': 'math_midterm',
        'Physics Final Exam': 'physics_final',
        'Chemistry Practical Test': 'chemistry_practical'
    };
    document.getElementById('examSelect').value = examMap[examName];
    loadExamQuestions();
}

function loadExamQuestions() {
    const examId = document.getElementById('examSelect').value;
    if(!examId) {
        document.getElementById('questionsList').style.display = 'none';
        document.getElementById('questionsEmptyState').style.display = 'block';
        return;
    }
    
    const examTitles = {
        'math_midterm': 'Mathematics Mid-Term Exam',
        'physics_final': 'Physics Final Exam',
        'chemistry_practical': 'Chemistry Practical Test'
    };
    
    document.getElementById('examTitle').textContent = examTitles[examId];
    document.getElementById('questionsList').style.display = 'block';
    document.getElementById('questionsEmptyState').style.display = 'none';
    
    // Display questions
    const questions = examQuestions[examId];
    const container = document.getElementById('questionsContainer');
    
    if(questions.length === 0) {
        container.innerHTML = '<p class="text-gray-600 text-center py-8">No questions added yet. Click "Add Question" to create questions for this exam.</p>';
    } else {
        container.innerHTML = questions.map((q, index) => `
            <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                <div class="flex justify-between items-start mb-2">
                    <h4 class="font-semibold text-gray-900">Question ${q.number} (${q.marks} marks)</h4>
                    <button onclick="deleteQuestion('${examId}', ${index})" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <p class="text-gray-700 mb-2">${q.text}</p>
                ${q.options ? `
                    <div class="text-sm text-gray-600 ml-4">
                        <p>A. ${q.options.A}</p>
                        <p>B. ${q.options.B}</p>
                        <p>C. ${q.options.C}</p>
                        <p>D. ${q.options.D}</p>
                        <p class="mt-1 text-green-600 font-medium">Correct Answer: ${q.correctAnswer}</p>
                    </div>
                ` : ''}
            </div>
        `).join('');
    }
}

function openAddQuestionModal() {
    const examId = document.getElementById('examSelect').value;
    if(!examId) {
        alert('Please select an exam first');
        return;
    }
    
    const questionType = document.getElementById('questionType').value;
    if(questionType === 'Objective') {
        document.getElementById('objectiveOptions').style.display = 'block';
    } else {
        document.getElementById('objectiveOptions').style.display = 'none';
    }
    
    document.getElementById('addQuestionModal').classList.remove('hidden');
    document.getElementById('addQuestionModal').classList.add('flex');
}

function closeAddQuestionModal() {
    document.getElementById('addQuestionModal').classList.add('hidden');
    document.getElementById('addQuestionModal').classList.remove('flex');
    document.getElementById('addQuestionForm').reset();
}

// Show/hide objective options based on question type
document.getElementById('questionType').addEventListener('change', function() {
    if(this.value === 'Objective') {
        document.getElementById('objectiveOptions').style.display = 'block';
    } else {
        document.getElementById('objectiveOptions').style.display = 'none';
    }
});

function saveQuestion(event) {
    event.preventDefault();
    const examId = document.getElementById('examSelect').value;
    const questionType = document.getElementById('questionType').value;
    
    const question = {
        number: document.getElementById('questionNumber').value,
        text: document.getElementById('questionText').value,
        marks: document.getElementById('questionMarks').value,
        type: questionType
    };
    
    if(questionType === 'Objective') {
        question.options = {
            A: document.getElementById('optionA').value,
            B: document.getElementById('optionB').value,
            C: document.getElementById('optionC').value,
            D: document.getElementById('optionD').value
        };
        question.correctAnswer = document.getElementById('correctAnswer').value;
    }
    
    examQuestions[examId].push(question);
    console.log('Question added:', question);
    alert('Question added successfully!');
    closeAddQuestionModal();
    loadExamQuestions();
}

function deleteQuestion(examId, index) {
    if(confirm('Are you sure you want to delete this question?')) {
        examQuestions[examId].splice(index, 1);
        loadExamQuestions();
    }
}
</script>
